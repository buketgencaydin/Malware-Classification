from VTService import VTService
import time

vt_service = VTService()

vt_api_keys = [] #write your own api keys

index = 0
vt_api_key_index = 0

for i in range(0,2):
    file = open("destination/malware_hashcode/" + str(i), "r")
    vt_result_file = open("destination/malware_vt_result/" + str(i), "w")

    print("FileName : " + str(i))

    for line in file:
        index = index + 1
        vt_api_key = vt_api_keys[vt_api_key_index]
        response = vt_service.fetch_engine_values(line.strip(), vt_api_key)
        print(str(time.strftime("%H-%M-%S")) + ": " + str(index) + ": " + vt_api_key + ": " + response)

        vt_api_key_index += 1

        if vt_api_key_index == len(vt_api_keys):
            vt_api_key_index = 0

        try:
            vt_result_file.write(response + "\n")
        except Exception as e:
            vt_result_file.write("Error\n")
            print(e)

        time.sleep(0.5)

    vt_result_file.close()
    file.close()
